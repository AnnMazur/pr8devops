name: CI/CD Demo Pipeline

on: [push]

jobs:
  ci-cd-demo:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      run: echo "Этап 1: Загружаем код из репозитория"

    - name: Docker Build Simulation
      run: |
        echo "Этап 2: Собираем Docker образ"
        echo "Команда: docker build -t todo-app:latest ."
        echo "Образ собран успешно"

    - name: Deploy to Kubernetes Simulation
      run: |
        echo "Этап 3: Развертывание в Kubernetes"
        echo "Команда: kubectl apply -f mongodb.yaml"
        echo "Команда: kubectl apply -f todo-app.yaml"
        echo "Приложение развернуто в кластере"

    - name: Generate Report
      run: |
        echo "Отчет CI/CD пайплайна" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "Выполненные этапы:" >> $GITHUB_STEP_SUMMARY
        echo "1. Загрузка кода из GitHub" >> $GITHUB_STEP_SUMMARY
        echo "2. Сборка Docker образа" >> $GITHUB_STEP_SUMMARY
        echo "3. Развертывание в Kubernetes" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "Использованные технологии:" >> $GITHUB_STEP_SUMMARY
        echo "- GitHub Actions (CI/CD)" >> $GITHUB_STEP_SUMMARY
        echo "- Docker" >> $GITHUB_STEP_SUMMARY
        echo "- Kubernetes" >> $GITHUB_STEP_SUMMARY
        echo "- MongoDB" >> $GITHUB_STEP_SUMMARY
